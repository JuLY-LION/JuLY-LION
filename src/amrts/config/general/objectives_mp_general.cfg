///////////////////////////////////////////////////////////////////////////////
//
// JuLY.LION
//
// Plug-n-play multiplayer objectives
//

// Music options //

CreateObjectType("music_common_list_default", "Objective") {
	// Strings (song #1)
	Condition("TRUE");
	Action() {
		Cmd("sound.player.clear");
		Cmd("exec music_common_list.cfg");
		Cmd("sound.player.play");
	}
}

CreateObjectType("music_common_list_2", "Objective") {
	// Polka (song #2)
	Condition("TRUE");
	Action() {
		Cmd("sound.player.clear");
		Cmd("exec music_common_list_2.cfg");
		Cmd("sound.player.play");
	}
}

CreateObjectType("music_common_list_3", "Objective") {
	// Mystery (song #3)
	Condition("TRUE");
	Action() {
		Cmd("sound.player.clear");
		Cmd("sound.player.addtrack '3_Mystery.mp3'");
		Cmd("sound.player.addtrack '4_Zwaga.mp3'");
		Cmd("sound.player.addtrack '5_Drums.mp3'");
		Cmd("sound.player.addtrack '6_Tubes.mp3'");
		Cmd("sound.player.addtrack '7_Chimes.mp3'");
		Cmd("sound.player.addtrack '8_Horns.mp3'");
		Cmd("sound.player.addtrack '1_Strings.mp3'");
		Cmd("sound.player.addtrack '2_Polka.mp3'");
		Cmd("sound.player.play");
	}
}


CreateObjectType("music_common_list_4", "Objective") {
	// Zwaga (song #4)
	Condition("TRUE");
	Action() {
		Cmd("sound.player.clear");
		Cmd("exec music_common_list_4.cfg");
		Cmd("sound.player.play");
	}
}

CreateObjectType("music_common_list_5", "Objective") {
	// Drums (song #5)
	Condition("TRUE");
	Action() {
		Cmd("sound.player.clear");
		Cmd("exec music_common_list_5.cfg");
		Cmd("sound.player.play");
	}
}

CreateObjectType("music_common_list_6", "Objective") {
	// Tubes (song #6)
	Condition("TRUE");
	Action() {
		Cmd("sound.player.clear");
		Cmd("exec music_common_list_6.cfg");
		Cmd("sound.player.play");
	}
}

CreateObjectType("music_common_list_7", "Objective") {
	// Chimes (song #7)
	Condition("TRUE");
	Action() {
		Cmd("sound.player.clear");
		Cmd("sound.player.addtrack '7_Chimes.mp3'");
		Cmd("sound.player.addtrack '8_Horns.mp3'");
		Cmd("sound.player.addtrack '1_Strings.mp3'");
		Cmd("sound.player.addtrack '2_Polka.mp3'");
		Cmd("sound.player.addtrack '3_Mystery.mp3'");
		Cmd("sound.player.addtrack '4_Zwaga.mp3'");
		Cmd("sound.player.addtrack '5_Drums.mp3'");
		Cmd("sound.player.addtrack '6_Tubes.mp3'");
		Cmd("sound.player.play");
	}
}

CreateObjectType("music_common_list_8", "Objective") {
	// Horns (song #8)
	Condition("TRUE");
	Action() {
		Cmd("sound.player.clear");
		Cmd("exec music_common_list_8.cfg");
		Cmd("sound.player.play");
	}
}

// Actual objectives //

CreateObjectType("mp.skirmish_setup", "Objective") {
	Condition("TRUE");
	
	Action() {
		NewObjective("common.killallenemy");
		NewObjective("mp.skirmish");
		DisplayObjective("Add", "build") {
			Text("Build a base and prepare for war.");
		}
	}
}

CreateObjectType("mp.skirmish", "Objective") {
	Condition("Timer") { Time(180); }
	Action() {
		DisplayObjective("Remove", "build");
		
		NewObjective("common.aivictory");
		NewObjective("mp.knockout");
		DisplayObjective("Add", "fight") {
			Text("Destroy all hostile bases.");
		}
		NewObjective("mp.noenemies");
	}
}
// ! KnockOut();
CreateObjectType("mp.noenemies", "Objective") { ObjectiveObj() {
	Condition("OR") {
		Condition("AND") {
			Condition("HaveType") {
				Type("army.building.hq1") { Operator("<"); Amount(1); }
			}
			Condition("HaveType") {
				Type("army.unit.bulldozer") { Operator("<"); Amount(1); }
			}
			Condition("OR") {
				Condition("HaveType") {
					Type("army.building.resourcedepot") { Operator("<"); Amount(1); }
				}
				Condition("HaveType") {
					Type("army.unit.dumptruck") { Operator("<"); Amount(1); }
				}
			}
		}
		Condition("AND") {
			Condition("HaveType") {
				Type("army.building.hq1") { Operator("<"); Amount(1); }
			}
			Condition("HaveType") {
				Type("army.building.barracks1") { Operator("<"); Amount(1); }
			}
			Condition("HaveType") {
				Type("army.building.garage1") { Operator("<"); Amount(1); }
			}
			Condition("HaveType") {
				Type("army.unit.sarge") { Operator("<"); Amount(1); }
			}
		}
	}

	Action() {
		NewObjective("mp.timer.knockout");
	}
} }

CreateObjectType("mp.knockout", "Objective") { ObjectiveObj() {
	Condition("OR") {
		Condition("AND") {
			Condition("HaveType") {
				Type("army.building.hq1") { Operator("<"); Amount(1); }
				Relation("Enemy");
				Combine(1);
			}
			Condition("HaveType") {
				Type("army.unit.bulldozer") { Operator("<"); Amount(1); }
				Relation("Enemy");
				Combine(1);
			}
			Condition("OR") {
				Condition("HaveType") {
					Type("army.building.resourcedepot") { Operator("<"); Amount(1); }
					Relation("Enemy");
					Combine(1);
				}
				Condition("HaveType") {
					Type("army.unit.dumptruck") { Operator("<"); Amount(1); }
					Relation("Enemy");
					Combine(1);
				}
			}
		}
		Condition("AND") {
			Condition("HaveType") {
				Type("army.building.hq1") { Operator("<"); Amount(1); }
				Relation("Enemy");
				Combine(1);
			}
			Condition("HaveType") {
				Type("army.building.barracks1") { Operator("<"); Amount(1); }
				Relation("Enemy");
				Combine(1);
			}
			Condition("HaveType") {
				Type("army.building.garage1") { Operator("<"); Amount(1); }
				Relation("Enemy");
				Combine(1);
			}
			Condition("HaveType") {
				Type("army.unit.sarge") { Operator("<"); Amount(1); }
				Relation("Enemy");
				Combine(1);
			}
		}
	}

	Action() {
		NewObjective("common.timer.win");
	}
} }



CreateObjectType("mp.timer.knockout", "Objective") { ObjectiveObj() {
    Condition("Timer") { Time(4); }
    Action() {
		KnockOut();
		DisplayObjective("Remove", "fight");
		DisplayObjective("Add", "rip") {
			Text("You have been eliminated.");
		}
    }
} }

CreateObjectType("mp.greatbattle", "Objective") { ObjectiveObj() {
	Condition("TRUE");
	
	Action() {
		NewObjective("mp.greatbattle_check");
		DisplayObjective("Add", "dp.mp.greatbattle") {
			Text("Destroy all enemy buildings.");
		}
		
		NewObjective("common.eliminate");
		NewObjective("common.killallenemy");
		NewObjective("common.aivictory");
	}
} }

CreateObjectType("mp.greatbattle_check", "Objective")
{
  GameObj();
  ObjectiveObj()
  {
    Condition("AND")
    {
      Condition("HaveType")
      {
        Relation("Enemy");
        Combine(1);
        Type("army.building.hq1")
        {
          Operator("<");
          Amount(1);
        }
      }
      Condition("HaveType")
      {
        Relation("Enemy");
        Combine(1);
        Type("army.building.barracks1")
        {
          Operator("<");
          Amount(1);
        }
      }
      Condition("HaveType")
      {
        Relation("Enemy");
        Combine(1);
        Type("army.building.garage1")
        {
          Operator("<");
          Amount(1);
        }
      }
      Condition("HaveType")
      {
        Relation("Enemy");
        Combine(1);
        Type("army.building.resourcedepot")
        {
          Operator("<");
          Amount(1);
        }
      }

      Condition("HaveType")
      {
        Type("army.building.hq2")
        {
          Operator(">=");
          Amount(1);
        }
      }
    }
    Action()
    {
      NewObjective("common.timer.win");
    }
  }
}